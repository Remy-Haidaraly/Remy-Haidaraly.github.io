---
title: Fuite en 1791
categories: [404CTF_2023, Web_404]
tags: [Parameter Pollution, Web]
image: '/assets/images/404CTF_2023/404CTF.jpg'
---

## ùÑû Introduction

![Intro](/assets/images/404CTF_2023/Web/Fuite_en_1791/intro.png)


## ùÑû Solution
L'objectif du challenge est trouver un moyen d'acc√©der √† certain lien.

![Accueil](/assets/images/404CTF_2023/Web/Fuite_en_1791/accueil.png)
Sur la page d'accueil, un lien est pr√©sent, mais lorsqu'on clique dessus, une erreur est renvoy√©e.

```
https://ddfc.challenges.404ctf.fr/ddfc?expiry=-5625891076&signature=wawF6dC4Hz9g5NyCc3j1KCDcfztFE/sp
```
![Link](/assets/images/404CTF_2023/Web/Fuite_en_1791/link.png)

En examinant les **param√®tres** de l'URL, nous remarquons ce qui semble √™tre un **Timestamp -5625891076**. En convertissant cette valeur √† l'aide d'un site tel que [epochconverter.com](https://www.epochconverter.com/), nous obtenons la date `"Wednesday, September 21, 1791 12:28:44 PM"``. Cela explique pourquoi nous obtenons une erreur indiquant que le lien a expir√©.

Le probl√®me est que si nous essayons de **modifier** la valeur du param√®tre **expiry**, une nouvelle erreur est renvoy√©e.
![Invalid](/assets/images/404CTF_2023/Web/Fuite_en_1791/invalid.png)

Si nous essayons de modifier la valeur du param√®tre **signature** en utilisant une valeur **al√©atoire** ou **vide**, une autre erreur est renvoy√©e.
![Missing](/assets/images/404CTF_2023/Web/Fuite_en_1791/missing.png)

J'ai essay√© d'ajouter la date **"Wednesday, September 21, 1791 12:28:44 PM"** au header **DATE** de ma requ√™te pour donner l'impression que la requ√™te a √©t√© effectu√©e avant la date d'expiration, je continue d'obtenir l'erreur indiquant que le lien a expir√© m√™me avant une date dans le futur.

Je d√©cide donc de chercher comment **manipuler** les param√®tres d'une URL et voir s'il y a quelque chose que je pourrais utiliser. J'ai d√©couvert une technique appel√©e [Parameter Pollution](https://book.hacktricks.xyz/pentesting-web/parameter-pollution)

J'ai donc essay√© d'appliquer cette technique en ajoutant un **deuxi√®me param√®tre expiry** correspondant √† un **Timestamp futur**, soit *5625891076* :
Qui correspond √† `Thursday, April 11, 2148 11:31:16 AM`

```
https://ddfc.challenges.404ctf.fr/ddfc?expiry=-5625891076&signature=wawF6dC4Hz9g5NyCc3j1KCDcfztFE/sp&expiry=5625891076
```
Le deuxi√®me **expiry** va "√©craser" la valeur du premier, rendant le lien valide !

ùÑû FLAG : `404CTF{l4_p011uti0n_c_3st_m41}` ùÑû


## ùÑû Conclusion
En r√©solvant le d√©fi "Fuite en 1791", j'ai r√©ussi √† trouver une solution en exploitant la vuln√©rabilit√© de **pollution de param√®tres**. En utilisant la technique de pollution de param√®tres, j'ai pu modifier la valeur du param√®tre expiry et rendre le lien valide. Ce d√©fi met en √©vidence l'importance de comprendre les m√©canismes des URL et les vuln√©rabilit√©s potentielles qui peuvent en d√©couler.



















